/*
 * jQuery Image Reveal - A Simple Before/After Image Viewer
 *
 * Version: Master
 * Homepage: http://github.com/lemoncreative/jquery-image-reveal
 * Licence: MIT
 * Copyright: (c) 2013 Lemon Creative;
 */
!function(t){t.fn.extend({imageReveal:function(i){function a(t,a){0>t&&(t=0),t>i.width&&(t=i.width),t<i.paddingLeft&&(t=i.paddingLeft),t>i.width-i.paddingRight&&(t=i.width-i.paddingRight),n[a].overlay.width(t);var e=t-i.barWidth/2;if(0>e&&(e=0),e>i.width-i.barWidth&&(e=i.width-i.barWidth),n[a].drag.css({left:e}),i.showCaption){var d=n[a].before.attr("title"),o=n[a].after.attr("title");t>i.width*i.captionChange?d&&""!==d?n[a].caption.text(d).fadeIn(i.captionFade||1e3).data("link",n[a].before.data("link")):n[a].caption.fadeOut(i.captionFade||1e3):o&&""!==o?n[a].caption.text(o).fadeIn(i.captionFade||1e3).data("link",n[a].after.data("link")):n[a].caption.fadeOut(i.captionFade||1e3)}}function e(e){var d=t(this).data("imageRevealID");if(!n[d].dragging&&"click"!==e.type)return!1;var o;return e.originalEvent&&e.originalEvent.changedTouches?(i.touchDevice||(i.touchDevice=!0,i.originalBarWidth=i.barWidth,i.barWidth=parseInt(i.touchBarWidth,10),t.each(i.ids,function(t,a){var e=n[a].drag.position().left-(i.touchBarWidth/2-i.originalBarWidth/2);n[a].drag.width(i.touchBarWidth).css({left:e})})),o=e.originalEvent.changedTouches[0].pageX):o=e.pageX,a(o-n[d].overlay.offset().left,d),!1}var n={};return i=t.extend({},{barWidth:20,touchBarWidth:60,startPosition:.5,paddingLeft:0,paddingRight:0,showCaption:!1,linkCaption:!1,captionChange:.5,width:500,height:500,ids:[]},i),i.ids=[],i.startPosition>1?i.startPosition=1:i.startPosition<0&&(i.startPosition=0),i.captionChange>1?i.captionChange=1:i.captionChange<0&&(i.captionChange=0),this.each(function(e){n[e]={},i.ids.push(e),n[e].container=t(this).addClass("imageReveal").data("imageRevealID",e);var d=n[e].container.children("img").first();i.width=d.width(),i.height=d.height(),n[e].before=n[e].container.children("img").first().width(i.width).height(i.height).hide(),n[e].after=n[e].before.next().width(i.width).height(i.height).hide(),n[e].container.width(i.width).height(i.height).css({overflow:"hidden",position:"relative"}).append('<div class="imageReveal-overlay"></div>').append('<div class="imageReveal-background"></div>').append('<div class="imageReveal-drag"></div>').append('<div class="imageReveal-caption">'+n[e].before.attr("title")+"</div>"),n[e].bg=n[e].container.children(".imageReveal-background").width(i.width).height(i.height).css({"background-image":"url("+n[e].after.attr("src")+")","background-size":i.width+"px "+i.height+"px"}),n[e].caption=n[e].container.children(".imageReveal-caption"),i.showCaption&&n[e].before.attr("title")&&""!==n[e].before.attr("title")?n[e].caption.show():n[e].caption.hide(),i.linkCaption&&n[e].caption.css("cursor","pointer").data("link",n[e].before.data("link")).on("click",function(){return n[e].caption.data("link")&&(window.location=n[e].caption.data("link")),!1}),n[e].overlay=n[e].container.children(".imageReveal-overlay").width(i.width).height(i.height).css({"background-image":"url("+n[e].before.attr("src")+")","background-size":i.width+"px "+i.height+"px"}).animate({width:i.width-i.width*i.startPosition}),n[e].drag=n[e].container.children(".imageReveal-drag").width(i.barWidth).height(i.height).animate({right:i.width*i.startPosition-i.barWidth/2}).on("mousedown touchstart",function(){return n[e].dragging=!0,n[e].drag.addClass("dragging"),!1}).on("mouseup touchend touchcancel",function(){return n[e].dragging=!1,n[e].drag.removeClass("dragging"),!1}),t(document).on("mouseup touchend touchcancel",function(){n[e].dragging&&(n[e].dragging=!1,n[e].drag.removeClass("dragging"))}),n[e].container.on("mouseout",function(t){n[e].dragging&&a(t.pageX-n[e].overlay.offset().left,e)})}).on("mousemove click touchmove",e)}})}(jQuery);
